@model ToDoList
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
}
<script src="~/lib/jquery/jquery.js"></script>

<h1>Add things to list</h1>

<table>
    <tr>
        <td>
            Task
        </td>
        <td>
            <input type="text" value="" name="task" id="txtTask" />
        </td>
    </tr>
    <tr>
        <td>
            <input type="button" id="btnSave" value="Save" />
        </td>
    </tr>
</table>
<table class="table-condensed" style="width: 100%" id="tableTasks">
    <thead>
        <tr>
            <th>
                Task
            </th>
        </tr>
    </thead>
</table>


<input type="button" value="Save Task" name="SaveData" id="btnSaveData" class="btn btn-primary" />



@using (Html.BeginForm("AddList", "ToDo", FormMethod.Post, new { @id = "formPost" }))
{
    <div class="row">
        <div class="col-sm-6">
            <div class="form form-horizontal">
                <div class="form-group">
                    <label>Nome:</label>
                    <input type="text" id="textNome" class="form-control" />
                </div>
                <div class="form-group">
                    <label>Telefone:</label>
                    <input type="text" id="textTel" class="form-control" />
                </div>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <button id="buttonAdicionar" type="button"
                        class="btn btn-primary">
                        Adicionar
                    </button>
                </div>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="form-horizontal">
                <table id="tablePost" class="table table-bordered table-striped">
                    <thead>
                        <tr>
                            <th>Nome</th>
                            <th>Telefone</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div class="form-group">
                    <label>&nbsp;</label>
                    <button id="buttonPost" type="button" class="btn btn-primary">
                        Postar
                    </button>
                </div>
            </div>
        </div>
    </div>
    <input type="hidden" name="ModelListName[<ZERO to LASTROW>].Property" value='<value>' />
}





<script>
        $("#buttonPost").click(function(){
            var listName = "NomeTels";

    var qtd = 0;
    $("#tablePost > tbody > tr").each(function () {
        var nome = $(this).data("nome");
        var tel = $(this).data("tel");
        $("#formPost").prepend("<input type='hidden' name='" + listName + "[" + qtd + "].Nome'value='"+nome+"'>");
        $("#formPost").prepend("<input type='hidden'name='" + listName + "[" + qtd + "].Telefone'value='" + tel + "'>");
        qtd += 1;
    });
         $.ajax({
            type: "POST",
            url: "ToDo/AddList",
            data: {test: JSON.stringify(listName)},
            success: function(r){
                alert(r + " task(s) inserted.")
            }
        })
        })

        $(document).ready(function(){
            $("#btnSave").click(function(){
                AddTask();
            });

            $("#btnSaveData").click(function(){
            test();
        });
        });

        function test(){
            var table = document.getElementById("tableTasks");
            var newarray = new Array();
            $("#tableTasks tr").each(function(){
                $(this).find("td").each(function(){
                    newarray.push($(this).text())
                })
            })
            //for(var i = 0; i < table.row[i]; i++){
                //newarray.push("2")
                //for(var j = 0, col; col = row.col[j]; j++){
                //    newarray.push(col.value())
                //}
            //}

            $.ajax({
            type: "POST",
            url: "ToDo/AddList",
            data: {test: JSON.stringify(newarray)},
            success: function(r){
                alert(r + " task(s) inserted.")
            }
        })
        }

        function AddTask(){
            var Task = "<tr><td>" + $("#txtTask").val() + "</td></tr>";
            $("#tableTasks").last().append(Task);
            $("#txtTask").val("");
        }

            $("#buttonAdicionar").on("click", function () {
                var nome = $("#textNome").val();
                var tel = $("#textTel").val();

                $("#tablePost > tbody").append("<tr data-nome='" +
                nome + "' data-tel='"+ tel +"'><td>" +
                nome + "</td><td>" + tel + "</td></tr>");

                $("#textNome").val('');
                $("#textTel").val('');

                $("#textNome").focus();
            });


        function myFunction(){
         var at = document.getElementById("test").value;
         var li = document.createElement("li");
         var node = document.createTextNode(at);
         li.appendChild(node);
         document.getElementById("list").appendChild(li);
        }


        function tests(){
            //var listOfTasks = new Array();
            //$("#tableTasks TBODY TR").each(function(){
            //    var row = $(this);
            //    var task = {};
            //    task.Task = row.find("td").eq(0).html();
            //    listOfTasks.push(task);
            //})
            var listName = "NomeTels";
            var micro = 22;
            var macro = ["ww","ss","22"];

    var qtd = 0;
    $("#tablePost > tbody > tr").each(function () {
        var nome = $(this).data("nome");
        var tel = $(this).data("tel");
        $("#formPost").prepend("<input type='hidden' name='" + listName + "[" + qtd + "].Nome'value='"+nome+"'>");
        $("#formPost").prepend("<input type='hidden'name='" + listName + "[" + qtd + "].Telefone'value='" + tel + "'>");
        qtd += 1;
    });


                $.ajax({
            type: "POST",
            url: "ToDo/AddList",
            data: {test: JSON.stringify(listName)},
            success: function(r){
                alert(r + " task(s) inserted.")
            }
        })
        }

         var data = [{ "firstName": "Danny", "lastName": "LaRusso", "phones":
         [{ "type": "Mobile", "number": "(555) 121-2121" },
         { "type": "Home", "number": "(555) 123-4567"}] },
         { "firstName": "Sensei", "lastName": "Miyagi", "phones":
         [{ "type": "Mobile", "number": "(555) 121-7777" },
         { "type": "Home", "number": "(555) 121-9999"}]}];

        //  function test() {
        //      var dataToPost = "{ country:'" + 2 + "', amount:" + 4.02 + "}";




        //$.ajax({
        //    url: @Url.Action("AddList","ToDo"),
        //    type: 'POST',
        //    dataType: 'json',
        //    data: {testing: JSON.stringify(dataToPost)},
        //    cache: false
        //    contentType: 'application/jsonrequest; charset=utf-8',
        //    dataType: 'json',
        //    success: function (result) {
        //        //  alert(result.ItemList[0].Str);
        //    }
        //});

</script>

@*

    var listName = "NomeTels";

    var qtd = 0;
    $("#tablePost > tbody > tr").each(function () {
    var nome = $(this).data("nome");
    var tel = $(this).data("tel");
    $("#formPost").prepend("<input type='hidden' name='" + listName + "[" + qtd + "].Nome'value='"+nome+"'>");
    $("#formPost").prepend("<input type='hidden'name='" + listName + "[" + qtd + "].Telefone'value='" + tel + "'>");
    qtd += 1;
    });


    function SaveTask() {
    var listOfTasks = new Array();
    $("#tableTasks").find("tr").slice(0).each(function(){
    var Task = $(this).find("td").eq(0).text();
    alert(task);
    });
    }

    <div class="main">
    <input type="text" name="addToList" id="test">
    <button onclick="myFunction()" id="btn">Submit</button>
    </div>

*@